{% extends "base.html" %}

{% set page_title = 'Deployments' %}

{% block page_header %}
    <style type="text/css">
        input[type="text"] {
            height: 41px !important;
        }

        .input-group {
            width: 220px !important;
        }

        .ghost-titlebar .action-btns li:first-child {
            margin: 0 !important;
        }
    </style>
    {% include 'partial_list_top_right.html' %}
    <caption>Sorted by timestamp descending</caption>
    <ul class="nav nav-stacked action-btns">
        <li>
            <form method="get" action="/web/deployments">
            <ul class="nav navbar-nav filter-group">
                <li class="filter">
                    <select name="env">
                        <option value="">Application environment</option>
                        {% for env in env_list: %}
                        <option value="{{ env }}" {% if env == request.args.get('env'): %}selected{% endif %}>{{ env }}</option>
                        {% endfor %}
                    </select>
                </li>
                <li class="filter">
                    <select name="role">
                        <option value="">Application role</option>
                        {% for role in role_list: %}
                        <option value="{{ role }}" {% if role == request.args.get('role'): %}selected{% endif %}>{{ role }}</option>
                        {% endfor %}
                    </select>
                </li>
                <li class="filter">
                    <div class="input-group" id="global-search">
                        <input type="text" name="application" class="form-control" placeholder="Search application..." value="{{ request.args.get('application') or '' }}"/>
                    </div>
                </li>
                <li class="filter">
                    <div class="input-group" id="global-search">
                        <input type="text" name="revision" class="form-control" placeholder="Module revision..." value="{{ request.args.get('revision') or '' }}"/>
                    </div>
                </li>
                <li class="filter">
                    <div class="input-group" id="global-search">
                        <input type="text" name="module" class="form-control" placeholder="Module name..." value="{{ request.args.get('module') or '' }}"/>
                    </div>
                </li>
                <li>
                    <button class="btn btn-raised btn-primary"><span class="glyphicon glyphicon-search"></span> Search</button>
                </li>
            </ul>
            </form>
        </li>
    </ul>
{% endblock %}"

{% block page_content %}
    <table class="table tablelist">
        <thead>
            <tr>
                <th>#</th>
                <th>Deployment</th>
                <th>Application</th>
                <th>Job</th>
                <th>Module / Path / Package</th>
                <th>Revision</th>
                <th>Commit</th>
                <th>Timestamp</th>
                <th>Deployment Date</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% include 'deployment_list_content.html' %}
            <tr id="loadmoreajaxloader">
                <td colspan="9" style="display:none;"><img src="{{ url_for('static', filename='ajax-loader.gif')}}" alt="Loading..."></td>
            </tr>
        </tbody>
    </table>
{% endblock %}