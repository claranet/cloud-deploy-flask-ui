{% extends "base.html" %}

{% set page_title = 'Applications List' %}

{% block page_content %}
    <h1>Available Applications</h1>
    <table class="table">
        <caption>Applications are sorted by last modification date</caption>
        <thead>
            <tr>
                <th>#</th>
                <th>Name / ID</th>
                <th>Created</th>
                <th>Modified</th>
                <th>Environment</th>
                <th>Role</th>
                <th>AWS Region</th>
                <th>AWS Instance Type</th>
                <th>AWS VPC</th>
                <th>Features</th>
                <th>Modules</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for app in apps | sort(reverse=True, attribute='_updated') %}
            <tr>
                <th scope="row">{{ loop.index }}</th>
                <td style="white-space:nowrap;">
                    {{ app['name'] }}
                    <br>
                    {{ app['_id'] }}
                </td>
                <td style="white-space:nowrap;">{{ app['_created'] }}</td>
                <td style="white-space:nowrap;">{{ app['_updated'] }}</td>
                <td>{{ app['env'] }}</td>
                <td>{{ app['role'] }}</td>
                <td style="white-space:nowrap;">{{ app['region'] }}</td>
                <td style="white-space:nowrap;">{{ app['instance_type'] }}</td>
                <td style="white-space:nowrap;">{{ app['vpc_id'] }}</td>
                <td style="white-space:nowrap;">
                    {% for feature in app['features'] %}
                        {{ feature['name'] }}:{{ feature['version'] }}<br>
                    {% endfor %}
                </td>
                <td style="white-space:nowrap;">
                    {% for module in app['modules'] %}
                        {{ module['name'] }}<br>
                    {% endfor %}
                </td>
                <td style="white-space:nowrap;">
                    <a href="/web/apps/{{ app['_id'] }}/deploy"><button class="btn btn-default">Deploy</button></a>
                    <a href="/web/apps/{{ app['_id'] }}/edit"><button class="btn btn-default">Edit</button></a>
                    <a href="/web/apps/{{ app['_id'] }}/delete"><button class="btn btn-default">Delete</button></a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}
